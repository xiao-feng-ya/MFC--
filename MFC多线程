在头文件
static UINT ThreadZ1(LPVOID* pParam);
CWinThread* ThreadXX1;


在源文件


开启线程
ThreadXX1=AfxBeginThread((AFX_THREADPROC)ThreadZ1, this);
ThreadXX1->SuspendThread();//   让线程等待
ThreadXX1->ResumeThread();//    唤醒暂停的线程
TerminateThread(ThreadXX1->m_hThread, 0);    //结束线程

//线程函数
UINT CcsDlg::ThreadZ1(LPVOID* pParam)
{
	while(TRUE)
	{
		i++;
		Sleep(1000);
	}
	return 0;
}

//只有开启过该线程，才能判断线程状态
DWORD code;
GetExitCodeThread(XX1->m_hThread, &code);
if (code == STILL_ACTIVE) {
    //线程仍在执行
		MessageBox(_T("开"));
	}
else {
		MessageBox(_T("关"));
		//线程停止执行,结束线程
	}
